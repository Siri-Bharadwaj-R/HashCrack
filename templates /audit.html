<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Password Strength Audit</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" type="image/svg+xml"
href="data:image/svg+xml,
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
  <rect width='100' height='100' rx='12' ry='12' fill='black'/>
  <text x='20' y='60' font-size='55' fill='white' font-family='monospace'>&gt;_</text>
</svg>">
</head>

<body>
    <h1>HashCrack // Password Strength Audit</h1>

    <p style="text-align:center; margin-top:-10px;">
        <a href="{{ url_for('dashboard') }}">‚Üê Back to Dashboard</a>
    </p>

    <div class="container">
        <form method="POST">
            <label>Enter Password:</label>
            <input type="text" name="password" required>

            <button type="submit">Analyze Strength</button>
        </form>

        {% if password %}
        <div class="analysis-section" style="margin-top:20px;">
            <h3>Password: {{ password }}</h3>

            <p>
                <span class="badge">Length: {{ analysis.length }}</span>
                <span class="badge">Entropy: {{ analysis.entropy }} bits</span>
                <span class="badge strength">{{ analysis.strength }}</span>
            </p>

            <p>Character sets used:
                {% if analysis.uses_lower %}<span class="badge">lowercase</span>{% endif %}
                {% if analysis.uses_upper %}<span class="badge">UPPERCASE</span>{% endif %}
                {% if analysis.uses_digits %}<span class="badge">digits</span>{% endif %}
                {% if analysis.uses_symbols %}<span class="badge">symbols</span>{% endif %}
            </p>

            <p>
                Estimated crack time:<br>
                CPU (10M/s): <strong>{{ analysis.cpu_time }}</strong><br>
                GPU (10B/s): <strong>{{ analysis.gpu_time }}</strong>
            </p>

            {% if analysis.patterns %}
            <p>Patterns detected:</p>
            <ul>
                {% for p in analysis.patterns %}
                    <li>{{ p }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
        {% endif %}

    </div>
</body>
</html>
